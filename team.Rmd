---
title: "Lab 5"
author: "Ashley Anderson & Hexiang Zhang"
date: "11/14/2019"
output: html_document
---

Repo Owner Username: ashleyna
Partner Username: hexzha
Repo Name: ds202_lab5

##Processing the Data

####1. Reading in the data:
```{r}
df <- read.table('diabetes.txt',header=TRUE)
head(df)
```

####2. Replacing missing values:
```{r, results="hide"}
df[df == ""] <- NA
droplevels(df)
```

####3. Dropping variables id, bp.2s, and bp.2d:
```{r message=FALSE, warning=FALSE}
library(tidyverse)
diabetes_reduced <- df %>% select(-one_of(c('id', 'bp.2s', 'bp.2d')))
```

####4. Dropping all rows with NAs:
```{r}
diabetes_clean <- diabetes_reduced %>% drop_na()
nrow(diabetes_clean)
ncol(diabetes_clean)
```

####5. Checking there are no NAs in the data set:
```{r}
index.na <- apply(is.na(diabetes_clean), 1, any)
sum(index.na)
```
Since the sum is 0, that means there are no TRUE (=1) values. In other words, there are no NAs. 


##Exploring and Transforming the Data

####6. Glyhb distribution:
```{r}
library(ggplot2)
ggplot(diabetes_clean, aes(x=glyhb)) + geom_histogram() + labs(title="Glycosolated Hemoglobin Distribution", x="Glycosolated Hemoglobin", y="Count")

diabetes_clean$glyhb_star <- log(diabetes_clean$glyhb)
```

We can perform a log transformation on glyhb, which will result in a less skewed histogram. While a log transformation will create a distribution closer to a normal distribution, it will definitely make our further analysis harder to interpret and explain. It is easier to explain how any value greater the 7.0 is considered diabetic, but log(7) = 1.946 is a bit harder to comparetively work with. In other words, most perople are generally more familar with the typical glycosolated hemoglobin scale than the log transformed one. On the other hand, this log transformation is a good option though because there are no glycosolated hemoglobin values near 0 and it ultimately fixes the right skewness in our histogram.   

####7. Glyhb distribution with log transformation: 
```{r}
ggplot(diabetes_clean, aes(x=glyhb_star)) + geom_histogram() + labs(title="Glycosolated Hemoglobin Distribution", x="log(Glycosolated Hemoglobin)", y="Count")
```

####8. Summary Statistics:
```{r}
diabetes_clean %>% 
  group_by(frame) %>% 
  summarise(mean.glyhb = mean(glyhb_star))

diabetes_clean %>% 
  mutate(diabetic = ifelse(glyhb_star>log(7),T,F)) %>% 
  group_by(diabetic) %>%
  summarise(mean.weight = mean(weight))

diabetes_clean %>% 
  mutate(diabetic = ifelse(glyhb_star>log(7),T,F)) %>% 
  group_by(diabetic) %>%
  summarise(mean.weight = mean(age))
```

##Visualizations

####10. 
```{r}
diabetes_clean %>% 
  group_by(frame,location) %>% 
  summarise (mean.glyhb_star= mean(glyhb_star)) %>%
  ggplot(aes(x=location, y=mean.glyhb_star, fill=frame)) + geom_bar(stat="identity", position = "dodge")
```

***
####11. Exploration with variable glyhb_star
```{r}
ggplot(diabetes_clean, aes(x=glyhb_star, y=ratio, color=gender)) + geom_jitter() + geom_smooth(method = "lm", se = FALSE) + labs(title="Glycosolated Hemoglobin by Ratio", x="Glycosolated Hemoglobin", y="Ratio (Cholesterol/HDL)")

ggplot(diabetes_clean, aes(x=glyhb_star, y=age, color=gender)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + labs(title="Glycosolated Hemoglobin by Age", x="Glycosolated Hemoglobin", y="Age")

ggplot(diabetes_clean, aes(x=glyhb_star, y=bp.1s, color=gender)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + labs(title="Glycosolated Hemoglobin by First Systolic Blood Pressure", x="Glycosolated Hemoglobin", y="Systolic Blood Pressure")  

ggplot(diabetes_clean, aes(x=glyhb_star, y=weight, color=gender)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + labs(title="Glycosolated Hemoglobin by Weight", x="Glycosolated Hemoglobin", y="Weight (lbs)")

ggplot(diabetes_clean, aes(x=glyhb_star, y=hip, color=gender)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + labs(title="Glycosolated Hemoglobin by Hip Size", x="Glycosolated Hemoglobin", y="Hip Size (inches)")

```

***
####12. Distinct patterns for hip and waist across different frames
```{r}
ggplot(diabetes_clean,aes(x=waist,y=hip)) + geom_jitter() + facet_grid(~frame)

ggplot(diabetes_clean,aes(x=waist,y=hip, color=frame)) + geom_jitter()
```

##Messy Data

*** 
####13. Spread and Gather

***
####14. 

##Regression Models

***
####15. Linear Regression Model
```{r}
fit <- lm(glyhb_star ~stab.glu + age + waist + ratio+ factor(frame),data=diabetes_clean)
summary(fit)
```

Based on the F-statistic, the p-value is <2.2e-16, which indicates the model is overall statistically significant. On the other hand, the adjusted $R^2$ is 0.557, meaning only 55.7% of the variation in 'glyhb_star' can be explained by the model. Based on our exploratory analysis, the variables all show a linear relationship with 'glyhb_star', indicating a multiple linear regression model is likely a good choice to start with.  

***
####16. Interpretations

*stab.glu: 

***
####17. Fitted Values
```{r}
fit$fitted.values
```

These estimated fitted values are estimated of our dependent variable 'glyhb_star' or glycosolated hemoglobin. 

***
####18. Inference vs. Prediction

***
####19. Linear Regression vs. K-NN Regression Models

##Reflection

***
####20. 
